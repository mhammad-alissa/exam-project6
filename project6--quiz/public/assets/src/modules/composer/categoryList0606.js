"use strict";define("composer/categoryList",["categorySelector","taskbar","api"],function(e,t,a){var o={};var n;o.init=function(t,a){var i=t.find(".category-list-container");if(!i.length){return}t.on("action:composer.resize",function(){c(t)});o.updateTaskbar(t,a);n=e.init(i.find('[component="category-selector"]'),{privilege:"topics:create",states:["watching","notwatching","ignoring"],onSelect:function(e){if(a.hasOwnProperty("cid")){r(t,a,e)}}});if(!n){return}if(a.cid&&a.category){n.selectedCategory={cid:a.cid,name:a.category.name}}else if(ajaxify.data.template.compose&&ajaxify.data.selectedCategory){n.selectedCategory={cid:ajaxify.data.cid,name:ajaxify.data.selectedCategory}}t.find(".category-name").translateText(n.selectedCategory?n.selectedCategory.name:"[[modules:composer.select_category]]").on("click",function(){e.modal({privilege:"topics:create",states:["watching","notwatching","ignoring"],openOnLoad:true,showLinks:false,onSelect:function(e){t.find(".category-name").text(e.name);n.selectCategory(e.cid);if(a.hasOwnProperty("cid")){r(t,a,e)}}})});c(t)};function c(e){e.find('.category-list-container [component="category-selector"]').toggleClass("dropup",e.outerHeight()<$(window).height()/2)}o.getSelectedCid=function(){var e;if(n){e=n.getSelectedCategory()}return e?e.cid:0};o.updateTaskbar=function(e,t){if(parseInt(t.cid,10)){a.get(`/categories/${t.cid}`,{}).then(function(t){i(e,t)})}};function i(e,a){if(a){var o=e.attr("data-uuid");t.update("composer",o,{image:a.backgroundImage,"background-color":a.bgColor,icon:a.icon&&a.icon.slice(3)})}}async function r(e,t,a){t.cid=a.cid;const o=await window.fetch(`${config.relative_path}/api/category/${a.cid}`).then(e=>e.json());t.category=o;i(e,o);require(["composer/scheduler","composer/tags"],function(n,c){n.onChangeCategory(o);c.onChangeCategory(e,t,a.cid,o);$(window).trigger("action:composer.changeCategory",{postContainer:e,postData:t,selectedCategory:a,categoryData:o})})}return o});
//# sourceMappingURL=categoryList.js.map